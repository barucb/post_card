
import { Input, Card, CardHeader, Divider, CardBody, Link } from "@nextui-org/react"
import { useSearchParams } from 'react-router-dom';
import share from './assets/share.svg'
import { ChangeEvent, useEffect, useState } from "react";
import toast from "react-hot-toast";

const App = () => {

    const [searchParams, setSearchParams] = useSearchParams();
    const [gender, setGender] = useState("");
    const [relation, setRelation] = useState("");
    const [currentUrl, setCurrentUrl] = useState("");

    useEffect(() => {
        // setCurrentUrl(window.location.href);
        const urlRelation = searchParams.get("relation") || "";
        setRelation(urlRelation);
    }, []);

    const handleFormState = (event: ChangeEvent<HTMLInputElement>) => {
        const { name, value } = event?.target;

        const updatedSearchParams = new URLSearchParams(searchParams.toString());
        updatedSearchParams.set(name, value);

        setSearchParams(updatedSearchParams);
    };

    const handleUpdateUrl = (selectedRelation: string): void => {
        const urlWithParams = new URL(window.location.href);
        const searchParams = new URLSearchParams(urlWithParams.search);

        searchParams.set('from', searchParams.get('from') || '');
        searchParams.set('to', searchParams.get('to') || '');
        searchParams.set('relation', selectedRelation);

        urlWithParams.search = searchParams.toString();

        window.history.replaceState({}, '', urlWithParams.toString());
    };


    const handleValidation = () => {
        if (!searchParams.get('from')) {
            toast.error('·ä•·â£·ä≠·ãé ·àµ·àû·âµ·äï ·ã´·àµ·åà·â°·ç°·ç°');
            return;
        }

        if (!searchParams.get('to')) {
            toast.error('·ä•·â£·ä≠·ãé ·ã®·â∞·âÄ·â£·ã©·äï ·àµ·àù ·ã´·àµ·åà·â°·ç°·ç°');
            return;
        }

        if (!gender) {
            toast.error("·ä•·â£·ä≠·ãé ·ã®·â∞·âÄ·â£·ã©·äï ·åæ·â≥ ·ã≠·àù·à®·å°::");
            return;
        }
        if (!relation) {
            toast.error("·ä•·â£·ä≠·ãé ·â∞·âÄ·â£·ã© ·ã®·ä•·à≠·à∂ ·àù·äï ·ä•·äï·ã∞·àÜ·äê ·ã≠·àù·à®·å°·ç°·ç°");
            return;
        }

        const currentSearchParams = new URLSearchParams(searchParams.toString());
        currentSearchParams.set('postcard', 'true');

        setSearchParams(currentSearchParams);
        handleUpdateUrl(relation);

        setCurrentUrl(window.location.href);
        // Add any additional logic for handling postcard visibility if needed
    };

    const handleCopyUrl = () => {
        navigator.clipboard.writeText(currentUrl);
        toast.success(`Link Copied Successfully! You can Share it to ${searchParams.get('to')} now`);
    };

    return (
        <main className="px-2 ">
            <div className={`mb-20 h-screen ${searchParams.get("postcard") === "true" ? "hidden" : ""}`}>

                <div className="h-20 flex justify-center relative bg-white w-full p-2">
                    <Link href="https://t.me/biranadigitals">
                        <img className="h-16 w-auto object-contain" src="./logo.png" alt="" />
                    </Link>
                </div>

                <div className="flex flex-col items-center">
                    <div id="big-text" className="text-[#fc7405] flex flex-col items-center py-5">
                        <h1 className="text-4xl py-2">·ã≤·åÇ·â≥·àç ·çñ·àµ·âµ·ä´·à≠·ãµ ·àà·ãà·ã≥·åÜ·âΩ·ãé ·ã≠·àã·ä©</h1>
                        <h1 className="text-xl ">Send an E-card for your beloved one!</h1>
                    </div>
                    <div className="flex flex-col w-[80%]   max-w-[400px]  py-2">
                        {/* <h3 className="py-2 font-bold text-3xl"> ·ãà·ã≥·åÖ ·ãò·àò·ãµ·ãé·äï ·ä•·äï·ä≥·äï ·ä†·ã∞·à®·à∞·ãé ·ã≠·â†·àâ!!</h3> */}
                        <form className="w-full max-w-[400px] flex flex-col gap-y-3">
                            <Input defaultValue={searchParams.get('from')!} className="bg-[#fc7405] font-medium" name="from" onChange={(e) => { console.log(e.target.value); handleFormState(e) }} type="text" label="Sender's Name (·ä® . . .?)" />
                            <Input defaultValue={searchParams.get('to')!} className="bg-[#fc7405] font-medium" name="to" onChange={(e) => { console.log(e.target.value); handleFormState(e) }} type="text" label="Receiver's Name (·àà . . .?)" />
                        </form>
                        <h5 className="pt-4  text-xl">·ã®·â∞·âÄ·â£·ã© ·åæ·â≥</h5>
                        <h5 className="pb-2  text-xl">Receiver's Gender</h5>
                        <div className="flex gap-3 m">
                            <button className={`px-4 py-2 rounded-md ${gender === "male" ? "bg-[#fc7405] text-white" : "bg-gray-200 "}`} onClick={() => setGender("male")}>·ãà·äï·ãµ</button>
                            <button className={`px-4 py-2 rounded-md ${gender === "female" ? "bg-pink-500 text-white" : "bg-gray-200 "}`} onClick={() => setGender("female")}>·à¥·âµ</button>
                        </div>
                        <h5 className="pt-4  text-xl">{gender === "female" ? "·â∞·âÄ·â£·ã≠·ãã " : "·â∞·âÄ·â£·ã© "} ·ã®·ä•·à≠·à∂ ·àù·äï·ãµ·äï {gender === "female" ? "·äì·âµ " : "·äê·ãç "}?</h5>
                        <h5 className="py-1  text-m">The Receiver is your . . .</h5>

                        <div className=" max-w-[500px] grid grid-cols-2 gap-3 ">
                            <button className={`${gender === "male" ? "block" : "hidden"} px-4 py-2 rounded-md ${relation === "maCr" ? "bg-[#fc7405]  text-white" : "bg-gray-200 "}`} onClick={() => { setRelation("maCr"); handleUpdateUrl("maCr"); }}>
                                ·ã®·àù·ãà·ã∞·ãç ·àç·åÖ ü•∞
                            </button>
                            <button className={`${gender === "female" ? "block" : "hidden"} px-4 py-2 rounded-md ${relation === "feCr" ? "bg-[#fc7405]  text-white" : "bg-gray-200 "}`} onClick={() => {
                                setRelation("feCr"); handleUpdateUrl("feCr");
                            }}
                            >
                                ·ã®·àù·ãà·ã≥·âµ ·àç·åÖ ü•∞
                            </button>
                            <button
                                className={`${gender === "male" ? "block" : "hidden"} px-4 py-2 rounded-md ${relation === "bf" ? "bg-[#fc7405]  text-white" : "bg-gray-200 "
                                    }`}
                                onClick={() => {
                                    setRelation("bf");
                                    handleUpdateUrl("bf");
                                }}
                            >
                                ·çç·âÖ·à®·äõ üë©üèª‚Äç‚ù§Ô∏è‚Äçüë®üèª
                            </button>
                            <button
                                className={`${gender === "male" ? "block" : "hidden"} px-4 py-2 rounded-md ${relation === "maFr" ? "bg-[#fc7405]  text-white" : "bg-gray-200 "}`} onClick={() => {
                                    setRelation("maFr");
                                    handleUpdateUrl("maFr");
                                }}
                            >
                                ·ã®·ãà·äï·ãµ ·åì·ã∞·äõ
                            </button>
                            <button
                                className={`${gender === "female" ? "block" : "hidden"} px-4 py-2 rounded-md ${relation === "gf" ? "bg-[#fc7405]  text-white" : "bg-gray-200 "
                                    }`}
                                onClick={() => {
                                    setRelation("gf");
                                    handleUpdateUrl("gf");
                                }}
                            >
                                ·çç·âÖ·à®·äõ  ,üë©üèª‚Äç‚ù§Ô∏è‚Äçüë®üèª
                            </button>
                            <button
                                className={`${gender === "female" ? "block" : "hidden"} px-4 py-2 rounded-md ${relation === "feFr" ? "bg-[#fc7405]  text-white" : "bg-gray-200 "}`} onClick={() => {
                                    setRelation("feFr");
                                    handleUpdateUrl("feFr");
                                }}
                            >
                                ·ã®·à¥·âµ ·åì·ã∞·äõ
                            </button>

                        </div>
                        {/* <Toaster
                                richColors

                                gap={48}
                                toastOptions={{
                                    unstyled: true,
                                    classNames: {
                                    },
                                }}
                                
                                position="bottom-center" /> */}
                        <p>relation: {relation}</p>
                        <button onClick={handleValidation} className="py-3  px-10 flex w-full my-5  max-w-[500px] justify-center bg-[#fc7405] rounded-lg font-medium text-white" >Generate</button>

                    </div>
                </div>

            </div>
            <div id="preview" className={`${searchParams.get("postcard") === "true" ? "flex" : "hidden"} h-screen w-full flex-col items-center  py-2`}>
                <Card className={`w-full max-w-[500px] h-full`}>
                    <div className="flex justify-center h-14 relative bg-white w-full p-2 cursor-pointer">
                        <img className="h-12 w-auto object-contain" src="./logo.png" alt="" />
                    </div>
                    <CardHeader className="flex justify-between gap-3">
                    </CardHeader>
                    <Divider />
                    <CardBody className="overflow-hidden relative">
                        {/* {relation === "bf" || relation === "gf" ?

                            <img className="   absolute w-full opacity-80 " src="./couples.png" alt="" />
                            :
                            <img className="   absolute w-full -top-16 left-28" src="./lomimotion.png" alt="" />
                        }
                        <img className="opacity-80  object-contain absolute w-full " src="./lomiwrwera.png" alt="" /> */}

                        <h1 id="big-text" className="text-2xl"> </h1>
                        <div>
                            {/* <span className="w-[60px] h-[60px] bg-[#fc7405] absolute rounded-full -right-5" /> */}
                            {/* <span className="w-[80px] h-[80px] bg-yellow-400 absolute rounded-full -left-8" /> */}
                            {/* <span className="w-[80px] h-[80px] bg-[#fc7405] absolute rounded-full top-[30%] left-10" /> */}
                        </div>
                        <div className="relative   text-black  py-2 text-lg  space-y-3 p-2 border border- rounded-lg shadow-sm mt-4">
                            <div className="flex justify-end text-2xl items-center gap-2">
                                <strong className=" opacity-70">·àà:</strong>
                                <div className="flex flex-col">
                                    <h1 className="text-lg font-bold"> <p className="text-2xl capitalize">{searchParams.get('to')}</p></h1>
                                </div>
                            </div>
                            <div className="relative  ">
                                <br />
                                <p className="font-bold text-2xl">
                                    {relation === "maCr" ? (<p className="text-center"> ·àà·ãà·äï·ãµ ·ä≠·à®·àΩ  <br />·àà·å•·àù·âÖ·âµ '·àõ·ã≠·àÜ·äê·äù ·âÄ·àö·à¥ ·ã≠·â†·å£·å†·àµ <br /> ·çè ·â•·àà·äï ·ä•·äï·àÇ·ãµ ·ä®·ä®·â∞·à´·ãç ·ãµ·à®·àµ üòÜü•∞</p>) : ""}

                                    {relation === "feCr" ? (<p className="text-center">
                                        ·àà·à¥·âµ ·ä≠·à®·àΩ <br />
                                        ·â£·àç·àò·å£ ·ä•·äï·ä≥·äï ·ä´·äï·â∫ ·â†·ä†·ä´·àç ·â£·àã·åà·äù·àΩ <br /> ·ã≤·åÇ·â≥·àâ·äï ·àé·àö ·â†·àµ·àç·ä¨ ·àã·ä©·àç·àΩ üòÜü•∞</p>) : ""}

                                    {relation === "bf" ? (<p className="text-center">·àà·â¶·ã≠·çç·à¨·äï·ãµ <br /> ·ã®·å•·àù·âÄ·â± '·àà·â≥ ·â∞·ãç·â†·àÖ ·àã·åç·äù·àÖ  <br />·ã®·àç·â§ ·àã·ã≠ ·äï·åâ·àµ ·à∞·à≠·ä≠·ä†·ã≤·àµ ·äê·ãç ·çç·âÖ·à≠·àÖ <br /></p>) : ""}
                                    {relation === "gf" ? (<p className="text-center">·ààgirlfriend <br />·ã®·å•·àù·âÄ·â± '·àà·â≥ ·äê·ã≠·àç·äù ·àã·åç·äù·àΩ   <br /> ·àÉ·åà·à≠ ·ã≠·ãà·âÖ·àç·äù ·äï·åç·àµ·â¥ ·ä•·äï·ã∞·àÜ·äï·àΩ <br /> ·ã∞·åç·àû . . . <br /> ·àù·äï·àù ·â£·âµ·ãò·äï·å™·àù ·ä•·äï·ã≤·àÅ ·âÜ·äï·åÜ ·äê·àΩ  </p>) : ""}
                                    {relation === "maFr" ? (<p className="text-center">lewend guadegna <br />·ä•·äï·ä≥·äï ·àà·â•·à≠·àÉ·äê ·å•·àù·âÄ·â± ·â†·à∞·àã·àù ·ä†·ã∞·à®·à∞·àÖ {searchParams.get('from')}.  <br />·àò·àç·ä´·àù ·â†·ä†·àç <br /><br /> <br />  </p>) : ""}
                                    {relation === "feFr" ? (<p className="text-center">·ààset guadegna <br />  <br /> <br /><br /> <br />  </p>) : ""}






                                    <br />



                                    {/* {gender === "male" ? " ·ãç·ã±" : "·ãç·ã∑"}

                  {" "}
                  {relation} */}

                                    {/* <p className="capitalize">·ä® {" "} {searchParams.get('from')}</p> */}
                                </p>
                            </div>
                        </div>
                        <div className="flex my-20  justify-center">

                            <Link href="/" className="text-xl text-center text-black bg-[#fc7405] mr-6 rounded-lg px-1  max-w-[100px] mt-16 ">
                                Generate new
                            </Link>
                            <div className="text-xl  bg-[#fc7405]  rounded-lg  px-1  max-w-[100px] mt-16 text-black">
                                <button onClick={handleCopyUrl}>

                                    <img className="h-10  m-2" src={share} alt="Share" />

                                </button>
                            </div>
                        </div>
                    </CardBody>
                </Card>
            </div>
        </main>
    )
}

export default App

